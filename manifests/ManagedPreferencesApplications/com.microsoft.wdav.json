{
    "title": "Microsoft Defender for Endpoint (com.microsoft.wdav)",
    "description": "Microsoft Defender for Endpoint settings",
    "properties": {
        "antivirusEngine": {
            "type": "object",
            "title": "Antivirus engine",
            "description": "Manages the preferences of the antivirus component of Microsoft Defender for Endpoint.",
            "links": [
                {
                    "rel": "More information",
                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#antivirus-engine-preferences"
                }
            ],
            "properties": {
                "enforcementLevel": {
                    "type": "string",
                    "title": "Enforcement level for antivirus engine",
                    "default": "real_time",
                    "description": "Enforcement level of antivirus engine. On-demand: Files are scanned only on demand; Passive: Same as on-demand, but also security intelligence updates are enabled, and the status menu icon is hidden; Real-time: Scan files as they are accessed.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#enforcement-level-for-antivirus-engine"
                        }
                    ],
                    "enum": [
                        "passive",
                        "on_demand",
                        "real_time"
                    ],
                    "options": {
                        "enum_titles": [
                            "Passive",
                            "On-demand",
                            "Real-time"
                        ]
                    }
                },
                "enableFileHashComputation": {
                    "type": "boolean",
                    "title": "Enable file hash computation",
                    "default": false,
                    "description": "When this feature is enabled, Defender for Endpoint will compute hashes for files it scans.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#configure-file-hash-computation-feature"
                        }
                    ]
                },
                "scanAfterDefinitionUpdate": {
                    "type": "boolean",
                    "title": "Run a scan after definitions are updated",
                    "default": true,
                    "description": "Specifies whether to start a process scan after new security intelligence updates are downloaded on the device. Enabling this setting will trigger an antivirus scan on the running processes of the device.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#run-a-scan-after-definitions-are-updated"
                        }
                    ]
                },
                "scanArchives": {
                    "type": "boolean",
                    "title": "Scanning inside archive files",
                    "default": true,
                    "description": "If true, Defender will unpack archives and scan files inside them. Otherwise archive content will be skipped, that will improve scanning performance.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#scan-archives-on-demand-antivirus-scans-only"
                        }
                    ]
                },
                "maximumOnDemandScanThreads": {
                    "type": "integer",
                    "title": "Degree of parallelism for on-demand scans",
                    "default": 2,
                    "description": "The number of threads used to perform the scan.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#degree-of-parallelism-for-on-demand-scans"
                        }
                    ]
                },
                "exclusionsMergePolicy": {
                    "type": "string",
                    "title": "Exclusions merge",
                    "default": "merge",
                    "description": "Specify the merge policy for exclusions. This can be a combination of administrator-defined and user-defined exclusions (merge) or only administrator-defined exclusions (admin_only). This setting can be used to restrict local users from defining their own exclusions.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#exclusion-merge-policy"
                        }
                    ],
                    "enum": [
                        "merge",
                        "admin_only"
                    ],
                    "options": {
                        "enum_titles": [
                            "Merge",
                            "Admin Only"
                        ]
                    }
                },
                "exclusions": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "Exclusions",
                        "properties": {
                            "$type": {
                                "type": "string",
                                "title": "Type",
                                "default": "excludedPath",
                                "description": "Specify content excluded from being scanned by type.",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#type-of-exclusion"
                                    }
                                ],
                                "enum": [
                                    "excludedPath",
                                    "excludedFileExtension",
                                    "excludedFileName"
                                ],
                                "options": {
                                    "enum_titles": [
                                        "Path",
                                        "File extension",
                                        "Process name"
                                    ]
                                }
                            },
                            "path": {
                                "type": "string",
                                "title": "Path",
                                "description": "Path to exclude, wildcards are supported",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#path-to-excluded-content"
                                    }
                                ]
                            },
                            "isDirectory": {
                                "type": "boolean",
                                "title": "Is directory",
                                "default": false,
                                "description": "Directory if selected, or file if not selected",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#path-type-file--directory"
                                    }
                                ]
                            },
                            "extension": {
                                "type": "string",
                                "title": "File extension",
                                "description": "Specify content excluded from being scanned by file extension.",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#file-extension-excluded-from-the-scan"
                                    }
                                ]
                            },
                            "name": {
                                "type": "string",
                                "title": "Process name",
                                "description": "Process name, either or full path or file name, wildcards supported",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#process-excluded-from-the-scan"
                                    }
                                ]
                            }
                        }
                    },
                    "title": "Scan exclusions",
                    "description": "Entities that have been excluded from the scan. Exclusions can be specified by full paths, extensions, or file names.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/mac-preferences#scan-exclusions"
                        }
                    ]
                },
                "allowedThreats": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "title": "Threat"
                    },
                    "title": "Allowed threats",
                    "description": "List of threats (identified by their name) that are not blocked by the product and are instead allowed to run.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#allowed-threats"
                        }
                    ]
                },
                "disallowedThreatActions": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "title": "Action",
                        "enum": [
                            "allow",
                            "restore"
                        ],
                        "options": {
                            "enum_titles": [
                                "Allow Threats (restricts users from allowing threats)",
                                "Restore Threats (restricts users from restoring threats from the quarantine)"
                            ]
                        }
                    },
                    "title": "Disallowed threat actions",
                    "description": "Restricts the actions that the local user of a device can take when threats are detected. The actions included in this list are not displayed in the user interface. Use unique values.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#disallowed-threat-actions"
                        }
                    ]
                },
                "threatTypeSettings": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "Setting",
                        "properties": {
                            "key": {
                                "type": "string",
                                "title": "Threat type",
                                "description": "Type of the threat for which the behavior is configured.",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#threat-type"
                                    }
                                ],
                                "enum": [
                                    "potentially_unwanted_application",
                                    "archive_bomb"
                                ],
                                "options": {
                                    "enum_titles": [
                                        "Potentially Unwanted Application",
                                        "Archive Bomb"
                                    ]
                                }
                            },
                            "value": {
                                "type": "string",
                                "title": "Action to take",
                                "default": "audit",
                                "description": "Action to take when coming across a threat of the type specified in the preceding section.",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#action-to-take"
                                    }
                                ],
                                "enum": [
                                    "audit",
                                    "block",
                                    "off"
                                ],
                                "options": {
                                    "enum_titles": [
                                        "Audit",
                                        "Block",
                                        "Off"
                                    ]
                                }
                            }
                        }
                    },
                    "title": "Threat type settings",
                    "description": "The threatTypeSettings preference in the antivirus engine is used to control how certain threat types are handled by the product.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#threat-type-settings"
                        }
                    ]
                },
                "threatTypeSettingsMergePolicy": {
                    "type": "string",
                    "title": "Threat type settings merge",
                    "default": "merge",
                    "description": "Specify the merge policy for threat type settings. This can be a combination of administrator-defined and user-defined settings (merge) or only administrator-defined settings (admin_only). This setting can be used to restrict local users from defining their own settings for different threat types.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#threat-type-settings-merge-policy"
                        }
                    ],
                    "enum": [
                        "merge",
                        "admin_only"
                    ],
                    "options": {
                        "enum_titles": [
                            "Merge",
                            "Admin Only"
                        ]
                    }
                },
                "scanResultsRetentionDays": {
                    "type": "string",
                    "title": "Antivirus scan history retention",
                    "default": "90",
                    "description": "The number of days (1-180) that results are retained in the scan history on the device.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#antivirus-scan-history-retention-in-days"
                        }
                    ]
                },
                "scanHistoryMaximumItems": {
                    "type": "string",
                    "title": "Maximum number of items in the antivirus scan history",
                    "default": "10000",
                    "description": "The maximum number of entries to keep in the scan history.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#maximum-number-of-items-in-the-antivirus-scan-history"
                        }
                    ]
                },
                "enableRealTimeProtection": {
                    "type": "boolean",
                    "title": "Real-time protection",
                    "default": true,
                    "description": "Locates and stops malware from installing or running on your device. You can turn off this setting for a short time before it turns back on automatically."
                },
                "passiveMode": {
                    "type": "boolean",
                    "title": "Passive mode",
                    "default": false,
                    "description": "Whether the antivirus engine runs in passive mode or not."
                }
            },
            "property_order": 5
        },
        "cloudService": {
            "type": "object",
            "title": "Cloud delivered protection preferences",
            "description": "Configure the cloud-driven protection features of Microsoft Defender for Endpoint.",
            "links": [
                {
                    "rel": "More information",
                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#cloud-delivered-protection-preferences"
                }
            ],
            "properties": {
                "enabled": {
                    "type": "boolean",
                    "title": "Cloud delivered protection",
                    "default": true,
                    "description": "Provides increased, faster protection with access to the latest protection data in the cloud. Works best with automatic sample submission turned on",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#enable--disable-cloud-delivered-protection"
                        }
                    ]
                },
                "diagnosticLevel": {
                    "type": "string",
                    "title": "Diagnostic data collection",
                    "default": "optional",
                    "description": "We encourage you to share your diagnostic and usage data with us to help improve Microsoft products and services.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#diagnostic-collection-level"
                        }
                    ],
                    "enum": [
                        "optional",
                        "required"
                    ],
                    "options": {
                        "enum_titles": [
                            "Optional",
                            "Required"
                        ]
                    }
                },
                "cloudBlockLevel": {
                    "type": "string",
                    "title": "Cloud Block Level",
                    "default": "normal",
                    "description": "Determines how aggressive Defender for Endpoint will be in blocking and scanning suspicious files.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#configure-cloud-block-level"
                        }
                    ],
                    "enum": [
                        "normal",
                        "moderate",
                        "high",
                        "high_plus",
                        "zero_tolerance"
                    ],
                    "options": {
                        "enum_titles": [
                            "Normal: The default blocking level",
                            "Moderate: Delivers verdict only for high confidence detections",
                            "High: Aggressively blocks unknown files while optimizing for performance (greater chance of blocking non-harmful files)",
                            "High Plus: Aggressively blocks unknown files and applies additional protection measures (might impact client device performance)",
                            "Zero Tolerance: Blocks all unknown programs"
                        ]
                    }
                },
                "automaticSampleSubmission": {
                    "type": "boolean",
                    "title": "Enable / disable automatic sample submissions",
                    "default": true,
                    "description": "Determines whether suspicious samples are sent to Microsoft.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#enable--disable-automatic-sample-submissions"
                        }
                    ]
                },
                "automaticDefinitionUpdateEnabled": {
                    "type": "boolean",
                    "title": "Automatic security intelligence updates",
                    "default": true,
                    "description": "Determines whether security intelligence updates are installed automatically:",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#enable--disable-automatic-security-intelligence-updates"
                        }
                    ]
                },
                "automaticSampleSubmissionConsent": {
                    "type": "string",
                    "title": "Automatic sample submission Consent",
                    "default": "safe",
                    "description": "Sends sample files to Microsoft to help protect device users and your organization from potential threats",
                    "enum": [
                        "none",
                        "safe",
                        "all"
                    ],
                    "options": {
                        "enum_titles": [
                            "None",
                            "Safe",
                            "All"
                        ]
                    }
                }
            },
            "property_order": 10
        },
        "userInterface": {
            "type": "object",
            "title": "User interface preferences",
            "description": "Manage the preferences for the user interface.",
            "links": [
                {
                    "rel": "More information",
                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#user-interface-preferences"
                }
            ],
            "properties": {
                "hideStatusMenuIcon": {
                    "type": "boolean",
                    "title": "Hide status menu icon",
                    "default": false,
                    "description": "Whether the status menu icon (shown in the top-right corner of the screen) is hidden or not.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/mac-preferences#show--hide-status-menu-icon"
                        }
                    ]
                },
                "userInitiatedFeedback": {
                    "type": "string",
                    "title": "User initiated feedback",
                    "default": "enabled",
                    "description": "Specify whether users can submit feedback to Microsoft by going to Help > Send Feedback.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#show--hide-option-to-send-feedback"
                        }
                    ],
                    "enum": [
                        "enabled",
                        "disabled"
                    ],
                    "options": {
                        "enum_titles": [
                            "Enabled",
                            "Disabled"
                        ]
                    }
                },
                "consumerExperience": {
                    "type": "string",
                    "title": "Control sign-in to consumer version",
                    "default": "enabled",
                    "description": "Specify whether users can sign into the consumer version of Microsoft Defender",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#control-sign-in-to-consumer-version-of-microsoft-defender"
                        }
                    ],
                    "enum": [
                        "enabled",
                        "disabled"
                    ],
                    "options": {
                        "enum_titles": [
                            "Enabled",
                            "Disabled"
                        ]
                    }
                }
            },
            "property_order": 15
        },
        "edr": {
            "type": "object",
            "title": "EDR preferences",
            "description": "Manage the preferences of the endpoint detection and response (EDR) component.",
            "links": [
                {
                    "rel": "More information",
                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#endpoint-detection-and-response-preferences"
                }
            ],
            "properties": {
                "tags": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "Tag",
                        "properties": {
                            "key": {
                                "type": "string",
                                "title": "Type of tag",
                                "description": "Specifies the type of tag",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#type-of-tag"
                                    }
                                ],
                                "enum": [
                                    "GROUP"
                                ],
                                "options": {
                                    "enum_titles": [
                                        "Group"
                                    ]
                                }
                            },
                            "value": {
                                "type": "string",
                                "title": "Value of tag",
                                "description": "Specifies the value of tag",
                                "links": [
                                    {
                                        "rel": "More information",
                                        "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#value-of-tag"
                                    }
                                ]
                            }
                        }
                    },
                    "title": "Device tags",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-preferences#device-tags"
                        }
                    ]
                },
                "groupIds": {
                    "type": "string",
                    "title": "Group identifier"
                }
            },
            "property_order": 20
        },
        "tamperProtection": {
            "type": "object",
            "title": "Tamper protection",
            "description": "Tamper protection helps prevent unauthorized removal of Microsoft Defender for Endpoint.",
            "links": [
                {
                    "rel": "More information",
                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/tamperprotection-macos"
                }
            ],
            "properties": {
                "enforcementLevel": {
                    "type": "string",
                    "title": "Enforcement level",
                    "default": "block",
                    "description": "Specifies if tamper protection is disabled, in audit mode, or enforced",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/tamperprotection-macos"
                        }
                    ],
                    "enum": [
                        "disabled",
                        "audit",
                        "block"
                    ],
                    "options": {
                        "enum_titles": [
                            "Disabled: Tamper protection is completely off",
                            "Audit: Tampering operations are logged, but not blocked",
                            "Block: Tamper protection is on, tampering operations are blocked"
                        ]
                    }
                },
                "exclusions": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "Process identity",
                        "properties": {
                            "path": {
                                "type": "string",
                                "title": "Process path",
                                "description": "Full and exact path to the process binary"
                            },
                            "teamId": {
                                "type": "string",
                                "title": "Process's TeamIdentifier",
                                "description": "Code signature TeamIdentifier"
                            },
                            "signingId": {
                                "type": "string",
                                "title": "Process's Signing Identifier",
                                "description": "Code signature Identifier"
                            },
                            "args": {
                                "type": "array",
                                "items": {
                                    "type": "string",
                                    "title": "Argument"
                                },
                                "title": "Process's arguments",
                                "description": "Command line arguments"
                            }
                        }
                    },
                    "title": "Process exclusions",
                    "description": "Defines process that can interfere with Defender without considering it tampering"
                }
            },
            "property_order": 25
        },
        "deviceControl": {
            "type": "object",
            "title": "Device Control",
            "description": "Device control can be used to customize the URL target for notifications raised by device control, and allow or block removable devices.",
            "links": [
                {
                    "rel": "More information",
                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-device-control-overview#device-control-policy"
                }
            ],
            "properties": {
                "navigationTarget": {
                    "type": "string",
                    "title": "Customize URL target for notifications raised by device control",
                    "description": "Configure the URL that is opened when end users click the notification shown when a device control policy is enforced.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-device-control-overview#customize-url-target-for-notifications-raised-by-device-control"
                        }
                    ]
                },
                "removableMediaPolicy": {
                    "type": "object",
                    "title": "Allow or block removable devices",
                    "description": "Restrict access to removable media.",
                    "links": [
                        {
                            "rel": "More information",
                            "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-device-control-overview#allow-or-block-removable-devices"
                        }
                    ],
                    "properties": {
                        "enforcementLevel": {
                            "type": "string",
                            "title": "Policy enforcement level",
                            "description": "Set the removable media enforcement level.",
                            "links": [
                                {
                                    "rel": "More information",
                                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-device-control-overview#policy-enforcement-level"
                                }
                            ],
                            "enum": [
                                "audit",
                                "block"
                            ],
                            "options": {
                                "enum_titles": [
                                    "Audit: A notification is displayed to the user, however the device can still be used.",
                                    "Block: A notification is displayed to the user, and the device cannot be used."
                                ]
                            }
                        },
                        "permission": {
                            "type": "array",
                            "items": {
                                "type": "string",
                                "title": "Permissions",
                                "enum": [
                                    "none",
                                    "read",
                                    "write",
                                    "execute"
                                ],
                                "options": {
                                    "enum_titles": [
                                        "None",
                                        "Read",
                                        "Write",
                                        "Execute"
                                    ]
                                }
                            },
                            "title": "Default permission level",
                            "description": "The default permission level for devices that do not match anything else in the policy.",
                            "links": [
                                {
                                    "rel": "More information",
                                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-device-control-overview#default-permission-level"
                                }
                            ]
                        },
                        "vendors": {
                            "type": "object",
                            "title": "Vendors",
                            "description": "Restrict removable media by vendor.",
                            "links": [
                                {
                                    "rel": "More information",
                                    "href": "https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/mac-device-control-overview#restrict-removable-media-by-vendor-product-and-serial-number"
                                }
                            ],
                            "properties": {
                                "{{key}}": {
                                    "type": "string",
                                    "title": "Vendor ID"
                                },
                                "{{value}}": {
                                    "type": "object",
                                    "title": "Vendor Details",
                                    "properties": {
                                        "permission": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "title": "Permissions",
                                                "enum": [
                                                    "none",
                                                    "read",
                                                    "write",
                                                    "execute"
                                                ],
                                                "options": {
                                                    "enum_titles": [
                                                        "None",
                                                        "Read",
                                                        "Write",
                                                        "Execute"
                                                    ]
                                                }
                                            },
                                            "title": "Permission level"
                                        },
                                        "products": {
                                            "type": "object",
                                            "title": "Products",
                                            "properties": {
                                                "{{key}}": {
                                                    "type": "string",
                                                    "title": "Product ID"
                                                },
                                                "{{value}}": {
                                                    "type": "object",
                                                    "title": "Product Details",
                                                    "properties": {
                                                        "permission": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "string",
                                                                "title": "Permissions",
                                                                "enum": [
                                                                    "none",
                                                                    "read",
                                                                    "write",
                                                                    "execute"
                                                                ],
                                                                "options": {
                                                                    "enum_titles": [
                                                                        "None",
                                                                        "Read",
                                                                        "Write",
                                                                        "Execute"
                                                                    ]
                                                                }
                                                            },
                                                            "title": "Permission level"
                                                        },
                                                        "serialNumbers": {
                                                            "type": "object",
                                                            "title": "Serial Numbers",
                                                            "properties": {
                                                                "{{key}}": {
                                                                    "type": "string",
                                                                    "title": "Serial Number"
                                                                },
                                                                "{{value}}": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "string",
                                                                        "title": "Permissions",
                                                                        "enum": [
                                                                            "none",
                                                                            "read",
                                                                            "write",
                                                                            "execute"
                                                                        ],
                                                                        "options": {
                                                                            "enum_titles": [
                                                                                "None",
                                                                                "Read",
                                                                                "Write",
                                                                                "Execute"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "title": "Serial Number Details"
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "policy": {
                    "type": "string",
                    "title": "Device Control Policy",
                    "description": "JSON string representing the device control policy"
                }
            },
            "property_order": 30
        },
        "features": {
            "type": "object",
            "title": "Features",
            "properties": {
                "dataLossPrevention": {
                    "type": "string",
                    "title": "Use Data Loss Prevention",
                    "default": "disabled",
                    "description": "Whether data loss prevention enforcement is enabled on the machine.",
                    "enum": [
                        "enabled",
                        "disabled"
                    ]
                },
                "scheduledScan": {
                    "type": "string",
                    "title": "Scheduled Scan",
                    "default": "enabled",
                    "description": "Schedule scans with Microsoft Defender for Endpoint.",
                    "enum": [
                        "enabled",
                        "disabled"
                    ]
                }
            },
            "property_order": 35
        },
        "networkProtection": {
            "type": "object",
            "title": "Network protection",
            "properties": {
                "enforcementLevel": {
                    "type": "string",
                    "title": "Enforcement level",
                    "default": "audit",
                    "description": "Specifies if network protection is disabled, in audit mode, or enforced",
                    "enum": [
                        "disabled",
                        "audit",
                        "block"
                    ]
                }
            },
            "property_order": 40
        },
        "dlp": {
            "type": "object",
            "title": "Data Loss Prevention",
            "properties": {
                "exclusions": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "Exclusion",
                        "properties": {
                            "signingId": {
                                "type": "string",
                                "title": "Signing ID",
                                "description": "The signing id of the application to exclude from data loss prevention."
                            }
                        }
                    },
                    "title": "Exclusions"
                },
                "features": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "Feature",
                        "properties": {
                            "name": {
                                "type": "string",
                                "title": "Feature Name",
                                "description": "The name of a DLP feature to enable or disable."
                            },
                            "state": {
                                "type": "string",
                                "title": "State",
                                "default": "enabled",
                                "description": "Enable a feature up to a deployment ring (default production), or force disable a feature for all rings.",
                                "enum": [
                                    "enabled",
                                    "disabled"
                                ]
                            },
                            "ring": {
                                "type": "string",
                                "title": "Release Ring",
                                "default": "production",
                                "description": "Limit enabling the feature to a specific deployment ring.",
                                "enum": [
                                    "insiderFast",
                                    "external",
                                    "production"
                                ]
                            }
                        }
                    },
                    "title": "Features"
                }
            },
            "property_order": 45
        },
        "scheduledScan": {
            "type": "object",
            "title": "Scheduled scan configuration",
            "properties": {
                "checkForDefinitionsUpdate": {
                    "type": "boolean",
                    "title": "Check for definitions update",
                    "default": false,
                    "description": "Check for definitions update before initiating a scheduled scan"
                },
                "dailyConfiguration": {
                    "type": "object",
                    "title": "Daily and Hourly quick scan configuration",
                    "description": "Check for definitions update before initiating a scheduled scan"
                },
                "ignoreExclusions": {
                    "type": "boolean",
                    "title": "Ignore exclusions",
                    "default": false,
                    "description": "Should exclusions be ignored during a scheduled scan"
                },
                "lowPriorityScheduledScan": {
                    "type": "boolean",
                    "title": "Low priority scheduled scan",
                    "default": false,
                    "description": "Should scheduled scan be run with low priority. (Scan might take longer to complete)."
                },
                "runScanWhenIdle": {
                    "type": "boolean",
                    "title": "Run scheduled scan when idle",
                    "default": false,
                    "description": "Run scheduled scan when the device is idle. Only applicable for weekly full scans."
                },
                "weeklyConfiguration": {
                    "type": "object",
                    "title": "Weekly scheduled scan configuration",
                    "description": "Should scheduled scan be run with low priority. (Scan might take longer to complete).",
                    "properties": {
                        "scanType": {
                            "type": "string",
                            "title": "Scan type",
                            "default": "quick",
                            "description": "Specifies the type of scan to perform.",
                            "enum": [
                                "quick",
                                "full"
                            ]
                        }
                    }
                }
            },
            "property_order": 50
        }
    }
}